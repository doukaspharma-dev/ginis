
<!DOCTYPE html>
<html lang="el">
<head>

  <meta charset="UTF-8">
  <title>Favicon Î•Ï€Î¹Î»Î¿Î³Î­Ï‚</title>
  <link rel="icon" href="data:,"> <!-- default -->
  <meta charset="UTF-8">
  <title>Î¤Î± Î´Î¹ÎºÎ¬ Î¼Î¿Ï… Ï‡ÏÎ®ÏƒÎ¹Î¼Î±</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" type="image/png" href="assets/unnamed.png">

  <style>
  
  



  </style>
</head>
<body>
  <style>
    #paletteModal .actions-row {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
      margin-top: 12px;
    }
    #paletteModal .actions-row button {
      padding: 6px 12px;
      border-radius: 8px;
    }
    </style>
  <!-- ÎœÏ€Î¿Ï…ÏÎ¼Ï€Î¿Ï…Î»Î®Î¸ÏÎµÏ‚ -->

<div class="bubbles">
  <span></span><span></span><span></span><span></span><span></span>
</div>


 
<div class="wrap">

<header>
  <div class="logo-title">
    <img src="assets/unnamed.png" alt="Logo">
    <div class="titles">
     <h1 class="typewriter">Î¤Î± Î´Î¹ÎºÎ¬ Î¼Î¿Ï… Ï‡ÏÎ®ÏƒÎ¹Î¼Î±</h1>
      <h2>Î¦Î±ÏÎ¼Î±ÎºÎµÎ¯Î¿ Î“ÎºÎ¯Î½Î·Ï‚ Îš. Î Î­Ï„ÏÎ¿Ï‚, Î Î¿Î»ÏÎ³Ï‰Î½Î¿.</h2>
      <h3>Î§ÏÎ®ÏƒÎ¹Î¼Î± ÎµÏÎ³Î±Î»ÎµÎ¯Î± ÎºÎ±Î¹ ÏƒÏÎ½Î´ÎµÏƒÎ¼Î¿Î¹</h3>
    </div>
  </div>
</header>


<div class="topbar">
  <!-- ÎšÎ¿Ï…Î¼Ï€Î¹Î¬ ÎºÎµÎ½Ï„ÏÎ¹ÎºÎ¬ -->
  <button id="addBtnTop">+ Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î½Î­Î¿Ï… link</button>
  <button id="undoBtnTop" class="gray" disabled>â†© Î‘Î½Î±Î¯ÏÎµÏƒÎ·</button>
  <button id="backupBtn">Backup</button>
  <button id="restoreBtn">Restore</button>


  <!-- Î”ÎµÎ¾Î¹Î¬ -->
<div class="topbar-right">
  <select id="themeSelect">
    <option value="dark">Dark ğŸŒ™</option>
    <option value="light">Light â˜€ï¸</option>
    <option value="green">Green ğŸŒµ</option>
    <option value="brown">Brown â˜•</option>
    <option value="purple">Purple ğŸª€</option>
    <option value="blue">Blue ğŸŒŠ</option>
    <option value="orange">Orange ğŸŠ</option>
    <option value="pink">Pink ğŸŒ¸</option>
  </select>
</div>
  </div>




<div id="categories"></div>
</div>


<footer>
  <div class="btnrow">
    <button id="addBtnFoot">+ Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î½Î­Î¿Ï… link</button>
  </div>
  <div class="note-wrapper">
    <div class="note">Î¦Ï„Î¹Î±Î³Î¼Î­Î½Î¿ Î¼Îµ Î±Î³Î¬Ï€Î· Î±Ï€ÏŒ Ï„Î¿ Doukas Pharmacy SupportÂ®</div>
  </div>
</footer>
<!-- ===== MODAL ÎÎ•ÎŸÎ¥ LINK ===== -->
<div class="modal" id="modalForm">
  <div class="box">
    <h3 id="modalTitle">ÎÎ­Î¿ link</h3>
    <form id="linkForm" autocomplete="off">
      <!-- URL -->
      <div class="row">
        <input autocomplete="off" type="text" id="url" placeholder="Î”Î¹ÎµÏÎ¸Ï…Î½ÏƒÎ· (URL)" required>
      </div>

      <!-- ÎŒÎ½Î¿Î¼Î± -->
      <div class="row">
        <input autocomplete="off" type="text" id="name" placeholder="ÎŒÎ½Î¿Î¼Î± (max 13)">
      </div>

      <!-- Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® -->
      <div class="row">
        <input autocomplete="off" type="text" id="desc" placeholder="Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®">
      </div>

      <!-- Icon ÎµÏ€Î¹Î»Î¿Î³Î­Ï‚ -->
      <div class="row">
        <label style="font-size:13px;">Î•Î¹ÎºÎ¿Î½Î¯Î´Î¹Î¿</label>
        <div class="icon-row">
          <select id="iconMode">
            <option value="auto">Î‘Ï…Ï„ÏŒÎ¼Î±Ï„Î¿ favicon</option>
            <option value="builtin">Î•Î½ÏƒÏ‰Î¼Î±Ï„Ï‰Î¼Î­Î½Î¿ ÎµÎ¹ÎºÎ¿Î½Î¯Î´Î¹Î¿</option>
            <option value="upload">Î‘Î½Î­Î²Î±ÏƒÎ¼Î± ÎµÎ¹ÎºÏŒÎ½Î±Ï‚...</option>
            <option value="url">Î‘Ï€ÏŒ URL...</option> <!-- ÎÎ•Î‘ ÎµÏ€Î¹Î»Î¿Î³Î® -->
          </select>

          <!-- Builtin -->
          <select id="builtinIcon" style="display:none">
            <option value="star">â˜… Î‘ÏƒÏ„Î­ÏÎ¹</option>
            <option value="heart">â¤ ÎšÎ±ÏÎ´Î¹Î¬</option>
            <option value="pill">ğŸ’Š Î§Î¬Ï€Î¹</option>
            <option value="firstaid">ğŸ©¹ Î ÏÏÏ„ÎµÏ‚ Î²Î¿Î®Î¸ÎµÎ¹ÎµÏ‚</option>
            <option value="link">ğŸ”— Link</option>
            <option value="doc">ğŸ“„ ÎˆÎ³Î³ÏÎ±Ï†Î¿</option>
          </select>

          <!-- Upload -->
          <input id="iconFile" type="file"
                 accept="image/*,.ico,.png,.jpg,.jpeg,.webp,.svg"
                 style="display:none">

          <!-- URL -->
          <input id="iconUrl" type="url"
                 placeholder="https://example.com/icon.png"
                 style="display:none; flex:1;">
        </div>

        <!-- Î ÏÎ¿ÎµÏ€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ· -->
        <div class="icon-preview" id="iconPreview" style="display:none">
          <span>Î ÏÎ¿ÎµÏ€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ·:</span>
          <img id="iconPreviewImg" alt="icon">
        </div>
      </div>

      <!-- Î•Ï€Î¹Î»Î¿Î³Î® / Î”Î·Î¼Î¹Î¿Ï…ÏÎ³Î¯Î± ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚ -->
      <div class="row">
        <select id="categorySelect"></select>
        <input autocomplete="off" type="text" id="newCategory" placeholder="ÎÎ­Î± ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±">
      </div>


      <!-- ÎšÎ¿Ï…Î¼Ï€Î¹Î¬ -->
      <div class="actions">
        <button type="button" id="cancelModal">Î†ÎºÏ…ÏÎ¿</button>
        <button type="submit">Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
      </div>
    </form>
  </div>
</div>

<div class="theme-toggle-wrapper">
  <span class="version">ver. 2.2.3i</span>
</div>



<!-- ===== MODAL Î Î‘Î›Î•Î¤Î‘Î£ Î§Î¡Î©ÎœÎ‘Î¤Î©Î ===== -->
<div class="modal" id="paletteModal">
  <div class="box">
    <h3>Î Î±Î»Î­Ï„Î± Î§ÏÏ‰Î¼Î¬Ï„Ï‰Î½</h3>

    <div class="row palette-row">
      <label for="bg1">Î¦ÏŒÎ½Ï„Î¿ 1</label>
      <input type="color" id="bg1" value="#0d1b2a">
      <div class="color-preview" id="preview-bg1"></div>
    </div>

    <div class="row palette-row">
      <label for="bg2">Î¦ÏŒÎ½Ï„Î¿ 2</label>
      <input type="color" id="bg2" value="#1b263b">
      <div class="color-preview" id="preview-bg2"></div>
    </div>

    <div class="row palette-row">
      <label for="card">ÎšÎ¬ÏÏ„Î±</label>
      <input type="color" id="card" value="#415a77">
      <div class="color-preview" id="preview-card"></div>
    </div>

    <div class="row palette-row">
      <label for="accent">ÎšÎ¿Ï…Î¼Ï€Î¯</label>
      <input type="color" id="accent" value="#2f80ed">
      <div class="color-preview" id="preview-accent"></div>
    </div>

    <div class="row palette-row">
      <label for="text">ÎšÎµÎ¯Î¼ÎµÎ½Î¿</label>
      <input type="color" id="text" value="#eaeef5">
      <div class="color-preview" id="preview-text"></div>
    </div>

    <div class="row palette-row">
      <label for="border">Î ÎµÏÎ¯Î³ÏÎ±Î¼Î¼Î±</label>
      <input type="color" id="border" value="#cccccc">
      <div class="color-preview" id="preview-border"></div>
    </div>

    <!-- Î•Î´Ï Î¼Î­Î½ÎµÎ¹ ÎºÎ±Î¹ Ï„Î¿ Auto-Backup Restore -->
    
    <!-- Î•Ï€Î¹Ï€Î»Î­Î¿Î½ ÎºÎ¿Ï…Î¼Ï€Î¹Î¬ Î¿ÏÎ¹Î¶ÏŒÎ½Ï„Î¹Î± -->
    <div class="actions-row">
      <button id="defaultPalette">Default</button>
      <button id="closePalette">ÎšÎ»ÎµÎ¯ÏƒÎ¹Î¼Î¿</button>
    </div>
  
    <div class="row palette-row">
      <label for="autoBackup">Auto-Backup Restore</label>
      <button id="autoBackupBtn">Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ¬</button>
    </div>
  </div>
</div>


<!-- ===== ÎšÎ¡Î¥Î¦ÎŸ ÎšÎŸÎ¥ÎœÎ Î™ Î“Î™Î‘ Î Î‘Î›Î•Î¤Î‘ ===== -->
<div id="paletteBtn" data-tooltip="Î¡Ï…Î¸Î¼Î¯ÏƒÎµÎ¹Ï‚ Ï‡ÏÏ‰Î¼Î¬Ï„Ï‰Î½"></div>





<script>
/* ===============================
   ğŸ“Œ ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· / ÎœÎµÏ„Î±Î²Î»Î·Ï„Î­Ï‚
   =============================== */
let collapsedCats = JSON.parse(localStorage.getItem("collapsedCats") || "[]");

let categories = {};   // { ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±: [ {url,name,desc,iconType,iconValue,pinned?}, ... ] }
let catOrder = [];     // Î£ÎµÎ¹ÏÎ¬ ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ·Ï‚ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¹ÏÎ½
let editing = null;    // {cat, idx}
let historyStack = []; // Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ Î³Î¹Î± undo

// Default Ï‡ÏÏÎ¼Î±Ï„Î±
let themeDefault = {
  bg1:"#1f1f1f", bg2:"#232429", card:"#2b2d33", text:"#eaeef5", accent:"#2f80ed"
};

/* ===============================
   ğŸ“Œ SVG Î•Î¹ÎºÎ¿Î½Î¯Î´Î¹Î± (Î´Î¹Î±Ï†Î±Î½Î®)
   =============================== */
function svgIcon(kind, active=false){
  const color = active ? "#ffd54f" : "#e8eaed";
  if(kind==="edit") return `
    <svg viewBox="0 0 24 24" aria-label="Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±" role="img">
      <path fill="${color}" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25z"/>
      <path fill="${color}" d="M20.71 7.04a1.003 1.003 0 0 0 0-1.42L18.37 3.29a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.83z"/>
    </svg>`;
  if(kind==="delete") return `
    <svg viewBox="0 0 24 24" aria-label="Î”Î¹Î±Î³ÏÎ±Ï†Î®" role="img">
      <path fill="${color}" d="M16 9v10H8V9h8m-1.5-6h-5l-1 1H5v2h14V4h-3.5l-1-1z"/>
    </svg>`;
  // pin
  return `
    <svg viewBox="0 0 24 24" aria-label="Pin" role="img">
      <path fill="${color}" d="M16,12V5l1-1V3H7V4l1,1v7L5,15v2h6v4h2v-4h6v-2L16,12z"/>
    </svg>`;
}

/* ===============================
   ğŸ“Œ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î”ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½
   =============================== */
function saveData(){
  localStorage.setItem("categories", JSON.stringify(categories));
  localStorage.setItem("catOrder", JSON.stringify(catOrder));
}
function loadData(){
  categories = JSON.parse(localStorage.getItem("categories") || "{}");
  catOrder = JSON.parse(localStorage.getItem("catOrder") || "[]");
}

/* ===============================
   ğŸ“Œ Î˜Î­Î¼Î± / Î§ÏÏÎ¼Î±Ï„Î±
   =============================== */

/* ===============================
   ğŸ“Œ Undo / Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ
   =============================== */
function pushHistory(){
  historyStack.push(JSON.stringify({
    categories: JSON.parse(JSON.stringify(categories)),
    catOrder: [...catOrder],
    theme: getTheme()
  }));
  if(historyStack.length > 80) historyStack.shift();
  updateUndoBtn();
}
function updateUndoBtn(){
  const b = document.getElementById("undoBtnTop");
  if(historyStack.length === 0){ b.disabled = true; b.classList.add("gray"); }
  else { b.disabled = false; b.classList.remove("gray"); }
}
function undo(){
  if(historyStack.length === 0) return;
  const snap = JSON.parse(historyStack.pop());
  categories = snap.categories;
  catOrder = snap.catOrder;
  applyTheme(snap.theme);
  saveData(); saveTheme(snap.theme);
  render();
  updateUndoBtn();
}

let firstLoad = true;

// Î ÏÎ¿ÏƒÎ¸Î­Ï„ÎµÎ¹ staggered animation ÏƒÏ„Î¹Ï‚ ÎºÎ¬ÏÏ„ÎµÏ‚ (Î¼ÏŒÎ½Î¿ ÏƒÏ„Î¿ Ï€ÏÏÏ„Î¿ render)
function animateCards() {
  if (!firstLoad) return;
  const cards = document.querySelectorAll(".card");
  cards.forEach((card, i) => {
    card.style.animationDelay = (i * 0.1) + "s";
  });
  firstLoad = false; // Î¼ÎµÏ„Î¬ Ï„Î·Î½ Ï€ÏÏÏ„Î· Ï†Î¿ÏÎ¬, Î´ÎµÎ½ Î¾Î±Î½Î±Ï„ÏÎ­Ï‡ÎµÎ¹
}

// Override render
const originalRender = render;
render = function() {
  originalRender();
  animateCards();
};


/* ===============================
   ğŸ“Œ Î’Î¿Î·Î¸Î¿Î¯
   =============================== */
function normalizeUrl(u){
  if(!u) return "";
  let s = u.trim();
  if(!/^https?:\/\//i.test(s)){
    if(/^www\./i.test(s)) s = "https://" + s;
    else s = "https://" + s;
  }
  return s;
}
function dedupeAdd(cat, linkObj){
  const url = linkObj.url;
  if(!(categories[cat])) categories[cat] = [];
  if(categories[cat].some(L => (L.url||"").toLowerCase() === url.toLowerCase())) return false;
  categories[cat].push(linkObj);
  return true;
}

// Î•Î¼Ï†Î±Î½Î¯Î¶ÎµÎ¹ Ï„Î± Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î± auto-backups ÎºÎ±Î¹ ÎµÏ€Î¹Ï„ÏÎ­Ï€ÎµÎ¹ restore
function showAutoBackups() {
  const backups = JSON.parse(localStorage.getItem("autoBackups") || "[]");
  if (!backups.length) {
    alert("Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ Î´Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î¿ auto-backup!");
    return;
  }

  let msg = "Î”Î¹Î±Î¸Î­ÏƒÎ¹Î¼Î± Auto-Backups:\n\n";
  backups.forEach((b, i) => {
    msg += i + ": " + b.timestamp + "\n";
  });
  msg += "\nÎ Î»Î·ÎºÏ„ÏÎ¿Î»ÏŒÎ³Î·ÏƒÎµ 0,1,2 Î³Î¹Î± Î½Î± Î´Î¹Î±Î»Î­Î¾ÎµÎ¹Ï‚:";

  const choice = prompt(msg);
  if (choice !== null && !isNaN(choice)) {
    restoreAutoBackup(parseInt(choice));
  }
}

// ÏƒÏÎ½Î´ÎµÏƒÎ· Ï„Î¿Ï… ÎºÎ¿Ï…Î¼Ï€Î¹Î¿Ï
document.getElementById("autoBackupBtn").addEventListener("click", showAutoBackups);


/* ===============================
   ğŸ“Œ Render â€” Î£Ï‡ÎµÎ´Î¯Î±ÏƒÎ· UI (Î¼Îµ Pin + Drag&Drop Î³Î¹Î± Î½Î­Î± links)
   =============================== */
function render(){
  const wrap = document.getElementById("categories");
  wrap.innerHTML = "";

  catOrder.forEach(cat=>{
    const sec = document.createElement("div");
    sec.className = "category";
    sec.draggable = true;
    sec.dataset.cat = cat;

    // Ï„Î¯Ï„Î»Î¿Ï‚ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚
    const title = document.createElement("div");
    title.className = "category-title";

    // ÏŒÎ½Î¿Î¼Î± Î±ÏÎ¹ÏƒÏ„ÎµÏÎ¬
    const h2 = document.createElement("h2");
    h2.textContent = cat;
    title.appendChild(h2);

    // actions Î´ÎµÎ¾Î¹Î¬
    const actions = document.createElement("div");
    actions.className = "cat-actions";

    const toggleBtn = document.createElement("span");
    toggleBtn.textContent = collapsedCats.includes(cat) ? "â–¸" : "â–¾";
    toggleBtn.className = "toggle-btn";
    actions.appendChild(toggleBtn);

    const renameBtn = document.createElement("span");
    renameBtn.className = "cat-btn rename";
    renameBtn.textContent = "âœ";
    actions.appendChild(renameBtn);

    const delBtn = document.createElement("span");
    delBtn.className = "cat-btn delcat";
    delBtn.textContent = "ğŸ—‘";
    actions.appendChild(delBtn);

    title.appendChild(actions);
    sec.appendChild(title);

    // grid Î¼Îµ links
    const grid = document.createElement("div");
    grid.className = "grid";
    grid.dataset.cat = cat;
    if (collapsedCats.includes(cat)) grid.classList.add("collapsed");
    sec.appendChild(grid);

    // event collapse
    toggleBtn.onclick = () => {
      const isCollapsed = grid.classList.toggle("collapsed");
      toggleBtn.textContent = isCollapsed ? "â–¸" : "â–¾";
      if (isCollapsed) {
        if (!collapsedCats.includes(cat)) collapsedCats.push(cat);
        const idx = catOrder.indexOf(cat);
        if (idx > -1) {
          catOrder.splice(idx, 1);
          catOrder.push(cat);
          saveData();
          render();
        }
      } else {
        collapsedCats = collapsedCats.filter(c => c !== cat);
      }
      localStorage.setItem("collapsedCats", JSON.stringify(collapsedCats));
    };

    // Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚ (links)
    const list = (categories[cat] || []);
    const orderIdx = list.map((_,i)=>i).sort((a,b)=>{
      const pa = !!(list[a] && list[a].pinned), pb = !!(list[b] && list[b].pinned);
      if(pa===pb) return a-b;
      return pb - pa;
    });

    orderIdx.forEach(idx=>{
      const l = list[idx] || {};

      let initialIcon = "";
      if(l.iconType === "upload" && l.iconValue){
        initialIcon = l.iconValue;
      }
      else if(l.iconType === "builtin" && l.iconValue){
        initialIcon = builtinToDataUrl(l.iconValue);
      }
      else if(l.iconType === "url" && l.iconValue){
        initialIcon = l.iconValue;
      }
      else if(l.url){
        try{
          const domain = (new URL(l.url)).hostname;
          if(domain) initialIcon = `https://www.google.com/s2/favicons?sz=64&domain=${domain}`;
          else initialIcon = 'assets/default-favicon.png';
        }catch(e){
          initialIcon = 'assets/default-favicon.png';
        }
      } else {
        initialIcon = 'assets/default-favicon.png';
      }

      const card = document.createElement("div");
      card.className="card";
      card.draggable=true;
      card.dataset.cat=cat;
      card.dataset.idx=idx;
      if(l.pinned) card.classList.add("pinned");

      // ğŸ‘‰ ÎÎ•ÎŸ Î¼ÎµÎ½Î¿Ï
      card.innerHTML = `
        <div class="menu-btn">â‹®</div>
        <div class="menu-popup">
          <button class="edit" aria-label="Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±">${svgIcon('edit')}</button>
          <button class="del" aria-label="Î”Î¹Î±Î³ÏÎ±Ï†Î®">${svgIcon('delete')}</button>
          <button class="pin" aria-label="Pin / Unpin">${svgIcon('pin', !!l.pinned)}</button>
        </div>
      `;

      const a = document.createElement("a");
      a.href = l.url || "#";
      a.target = "_blank";
      a.rel = "noopener";
      a.draggable = false;

      const img = document.createElement("img");
      img.className = "favicon";
      img.setAttribute("alt", l.name || "");
      img.draggable = false;

      img._triedDefault = false;
      img._triedBuiltin = false;

      const onErr = function(){
        img.removeEventListener('error', onErr);
        if(!img._triedDefault){
          img._triedDefault = true;
          img.addEventListener('error', onErr);
          img.src = 'assets/default-favicon.png';
        } else if(!img._triedBuiltin){
          img._triedBuiltin = true;
          img.src = builtinToDataUrl("link");
        }
      };
      img.addEventListener('error', onErr);

      img.addEventListener('load', function(){
        if(img.naturalWidth < 32){
          img.src = 'assets/default-favicon.png';
        }
      });

      img.src = initialIcon;

      const titleDiv = document.createElement("div");
      titleDiv.className = "link-title";
      titleDiv.style.color = "var(--text)";
      titleDiv.textContent = (l.name||"").slice(0,13);

      const descDiv = document.createElement("div");
      descDiv.className = "link-desc";
      descDiv.textContent = l.desc || "";

      a.appendChild(img);
      a.appendChild(titleDiv);
      a.appendChild(descDiv);

      card.appendChild(a);
      grid.appendChild(card);
    });

    // ğŸ‘‰ Drag & Drop Î½Î­Î± links
    sec.addEventListener("dragover", e => {
      e.preventDefault();
      sec.classList.add("drag-over");
    });
    sec.addEventListener("dragleave", () => {
      sec.classList.remove("drag-over");
    });
    sec.addEventListener("drop", e => {
      e.preventDefault();
      sec.classList.remove("drag-over");
      const url = e.dataTransfer.getData("text/uri-list") || e.dataTransfer.getData("text/plain");
      if (!url) return;
      fetchTitle(url).then(title => {
        const newLink = {
          url,
          name: title || (new URL(url).hostname),
          desc: "",
          iconType: "auto",
          iconValue: ""
        };
        if (!categories[cat]) categories[cat] = [];
        categories[cat].push(newLink);
        saveData();
        render();
      });
    });

    wrap.appendChild(sec);
  });
}

/* ===============================
   ğŸ“Œ Î£Ï…Î½Î¬ÏÏ„Î·ÏƒÎ· Î³Î¹Î± Î½Î± Î²ÏÎ¯ÏƒÎºÎ¿Ï…Î¼Îµ Ï„Î¿Î½ Ï„Î¯Ï„Î»Î¿ ÏƒÎµÎ»Î¯Î´Î±Ï‚
   =============================== */
async function fetchTitle(url) {
  try {
    const res = await fetch(url, { mode: "cors" });
    const html = await res.text();
    const doc = new DOMParser().parseFromString(html, "text/html");
    return doc.querySelector("title")?.innerText.trim();
  } catch {
    return "";
  }
}



/* ===============================
   ğŸ“Œ Listeners â€” ÎšÎ¿Ï…Î¼Ï€Î¹Î¬ ÎºÎ±Î¹ Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚
   =============================== */
   
// Modal Î½Î­Î¿ link
["addBtnTop","addBtnFoot"].forEach(id =>
  document.getElementById(id).onclick = () => {
    editing = null;
    document.getElementById("modalTitle").innerText = "ÎÎ­Î¿ link";
    document.getElementById("linkForm").reset();
    document.getElementById("iconPreview").style.display="none";
    document.getElementById("builtinIcon").style.display="none";
    document.getElementById("iconFile").style.display="none";
    document.getElementById("iconMode").value="auto";

    document.getElementById("categorySelect").innerHTML =
      catOrder.map(c=>`<option>${c}</option>`).join("");

    document.getElementById("modalForm").style.display = "flex";
  }
);
document.getElementById("cancelModal").onclick =
  () => document.getElementById("modalForm").style.display = "none";

// Icon mode switching
const iconModeEl = document.getElementById("iconMode");
const builtinEl  = document.getElementById("builtinIcon");
const iconFileEl = document.getElementById("iconFile");
const iconUrlEl  = document.getElementById("iconUrl"); // ÎÎ•ÎŸ input
const iconPrev   = document.getElementById("iconPreview");
const iconPrevImg= document.getElementById("iconPreviewImg");

iconModeEl.addEventListener("change", ()=>{
  builtinEl.style.display  = iconModeEl.value==="builtin" ? "inline-block" : "none";
  iconFileEl.style.display = iconModeEl.value==="upload"  ? "inline-block" : "none";
  iconUrlEl.style.display  = iconModeEl.value==="url"     ? "inline-block" : "none";
  iconPrev.style.display   = "none";
});

builtinEl.addEventListener("change", ()=>{
  const url = builtinToDataUrl(builtinEl.value);
  iconPrevImg.src = url; 
  iconPrev.style.display="flex";
});

iconFileEl.addEventListener("change", ()=>{
  const f = iconFileEl.files && iconFileEl.files[0];
  if(!f) return;
  const r = new FileReader();
  r.onload = () => { 
    iconPrevImg.src = r.result; 
    iconPrev.style.display="flex"; 
  };
  r.readAsDataURL(f);
});

// ÎÎ•ÎŸ: Î±Ï€ÏŒ URL
iconUrlEl.addEventListener("input", ()=>{
  const u = iconUrlEl.value.trim();
  if(u){
    iconPrevImg.src = u;
    iconPrev.style.display="flex";
  }else{
    iconPrev.style.display="none";
  }
});

// Helper: emoji ÏƒÎµ PNG dataURL
function builtinToDataUrl(type){
  const map = {
    star: "â˜…",
    heart: "â¤",
    pill: "ğŸ’Š",
    firstaid: "ğŸ©¹",
    link: "ğŸ”—",
    doc: "ğŸ“„"
  };
  const emoji = map[type] || "ğŸ”—";
  const canvas = document.createElement("canvas");
  canvas.width = 64; 
  canvas.height = 64;
  const ctx = canvas.getContext("2d");
  ctx.font = "48px serif";
  ctx.textAlign = "center";
  ctx.textBaseline = "middle";
  ctx.fillText(emoji, 32, 32);
  return canvas.toDataURL("image/png");
}


// Demo: Ï…Ï€Î¿Î²Î¿Î»Î® Ï†ÏŒÏÎ¼Î±Ï‚
document.getElementById("linkForm").onsubmit = e => {
  e.preventDefault();
  alert("Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· link Î¼Îµ iconType=" + iconModeEl.value);
};


// Î¥Ï€Î¿Î²Î¿Î»Î® Ï†ÏŒÏÎ¼Î±Ï‚
const urlEl = document.getElementById("url"),
      nameEl = document.getElementById("name"),
      descEl = document.getElementById("desc"),
      catSel = document.getElementById("categorySelect"),
      newCatEl = document.getElementById("newCategory");

document.getElementById("linkForm").onsubmit = e => {
  e.preventDefault();
  const url = normalizeUrl(urlEl.value);
  const name = nameEl.value.trim();
  const desc = descEl.value.trim();
  if(!url){ alert("Î Î±ÏÎ±ÎºÎ±Î»Ï ÎµÎ¹ÏƒÎ¬Î³ÎµÏ„Îµ URL"); return; }

  let cat = catSel.value, newCat = newCatEl.value.trim();
  if(newCat) cat = newCat;

  if(!categories[cat]){ pushHistory(); categories[cat]=[]; catOrder.push(cat); }

  // ÎµÎ¹ÎºÎ¿Î½Î¯Î´Î¹Î¿
  let iconType = iconModeEl.value;
  let iconValue = null;
  if(iconType==="builtin"){
    iconValue = builtinEl.value || "link";
  }else if(iconType==="upload"){
    if(iconFileEl.files && iconFileEl.files[0]){
      iconValue = iconPrevImg.src || null;
    }else{
      iconType = "auto";
    }
  }else if(iconType==="url"){     // ÎÎ•ÎŸ mode
    if(iconUrlEl.value.trim()){
      iconValue = iconUrlEl.value.trim();
    }else{
      iconType = "auto";
    }
  }

  pushHistory();
  const baseObj = { url, name, desc, iconType, iconValue };
  if(editing){
    const prev = categories[editing.cat][editing.idx] || {};
    const updated = { ...baseObj, pinned: !!prev.pinned }; // ÎºÏÎ±Ï„Î¬Î¼Îµ Ï„Î¿ pinned
    categories[editing.cat][editing.idx] = updated;
  }else{
    const linkObj = { ...baseObj, pinned:false };
    dedupeAdd(cat, linkObj);
  }

  saveData(); render();
  document.getElementById("modalForm").style.display = "none";
};


// Î•Î½Î­ÏÎ³ÎµÎ¹ÎµÏ‚ ÏƒÎµ ÎºÎ¬ÏÏ„ÎµÏ‚/ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚
document.addEventListener("click", e => {
  const target = e.target;

  /* ---------------------------
     Toggle popup menu
  --------------------------- */
  if (target.closest(".menu-btn")) {
    const btn = target.closest(".menu-btn");
    const menu = btn.nextElementSibling;
    // ÎºÎ»ÎµÎ¯ÏƒÎµ ÏŒÎ»Î± Ï„Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î±
    document.querySelectorAll(".menu-popup").forEach(m => {
      if (m !== menu) m.style.display = "none";
    });
    // Î¬Î½Î¿Î¹Î¾Îµ/ÎºÎ»ÎµÎ¯ÏƒÎµ Ï„Î¿ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î¿
    menu.style.display = (menu.style.display === "flex" ? "none" : "flex");
    return;
  }

  // ÎšÎ»Î¹Îº Î­Î¾Ï‰ -> ÎºÎ»ÎµÎ¯Î½Î¿Ï…Î½ ÏŒÎ»Î± Ï„Î± popup
  if (!target.closest(".menu-popup")) {
    document.querySelectorAll(".menu-popup").forEach(m => m.style.display = "none");
  }

  /* ---------------------------
     Î”Î¹Î±Î³ÏÎ±Ï†Î® link
  --------------------------- */
  if (target.closest(".del")) {
    const c = target.closest(".card");
    const catName = c.dataset.cat;
    pushHistory();
    categories[catName].splice(+c.dataset.idx, 1);
    if (categories[catName].length === 0) {
      delete categories[catName];
      catOrder = catOrder.filter(x => x !== catName);
    }
    saveData();
    render();
    return;
  }

  /* ---------------------------
     Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± link
  --------------------------- */
  if (target.closest(".edit")) {
    const c = target.closest(".card");
    editing = { cat: c.dataset.cat, idx: +c.dataset.idx };
    const l = categories[editing.cat][editing.idx];

    urlEl.value = l.url;
    nameEl.value = l.name || "";
    descEl.value = l.desc || "";
    catSel.innerHTML = catOrder.map(x =>
      `<option ${x === editing.cat ? "selected" : ""}>${x}</option>`
    ).join("");
    newCatEl.value = "";

    // icon Ï€ÏÎ¿ÎµÏ€Î¹ÏƒÎºÏŒÏ€Î·ÏƒÎ·
    iconModeEl.value = l.iconType || "auto";
    builtinEl.style.display = iconModeEl.value === "builtin" ? "inline-block" : "none";
    iconFileEl.style.display = iconModeEl.value === "upload" ? "inline-block" : "none";
    iconPrev.style.display = "none";
    if (l.iconType === "builtin") {
      builtinEl.value = l.iconValue || "link";
      iconPrevImg.src = builtinToDataUrl(builtinEl.value);
      iconPrev.style.display = "flex";
    } else if (l.iconType === "upload" && l.iconValue) {
      iconPrevImg.src = l.iconValue;
      iconPrev.style.display = "flex";
    }

    document.getElementById("modalTitle").innerText = "Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î± link";
    document.getElementById("modalForm").style.display = "flex";
    return;
  }

  /* ---------------------------
     ÎœÎµÏ„Î¿Î½Î¿Î¼Î±ÏƒÎ¯Î± ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚
  --------------------------- */
  if (target.closest(".rename")) {
    const cat = target.closest(".category").dataset.cat;
    const newN = prompt("ÎÎ­Î¿ ÏŒÎ½Î¿Î¼Î±:", cat);
    if (newN && newN !== cat) {
      pushHistory();
      categories[newN] = categories[cat];
      delete categories[cat];
      catOrder[catOrder.indexOf(cat)] = newN;
      saveData();
      render();
    }
    return;
  }

  /* ---------------------------
     Î”Î¹Î±Î³ÏÎ±Ï†Î® ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚
  --------------------------- */
  if (target.closest(".delcat")) {
    const cat = target.closest(".category").dataset.cat;
    if (confirm("Î”Î¹Î±Î³ÏÎ±Ï†Î® " + cat + ";")) {
      pushHistory();
      delete categories[cat];
      catOrder = catOrder.filter(c => c !== cat);
      saveData();
      render();
    }
    return;
  }

  /* ---------------------------
     Pin / Unpin
  --------------------------- */
  if (target.closest(".pin")) {
    const card = target.closest(".card");
    const cat = card.dataset.cat;
    const idx = +card.dataset.idx;
    const item = categories[cat][idx];
    if (!item) return;
    pushHistory();
    item.pinned = !item.pinned;
    saveData();
    render();
    return;
  }
});







/* ===============================
   ğŸ“Œ Backup & Restore
   =============================== */
document.getElementById("backupBtn").onclick=()=>{
  const blob=new Blob([JSON.stringify({
    categories,catOrder,theme:getTheme(),version:3
  },null,2)],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="bookmarks_backup.json";
  a.click();
};

document.getElementById("restoreBtn").onclick=()=>{
  const choice = confirm("OK: Î•Ï€Î±Î½Î±Ï†Î¿ÏÎ¬ Î±Ï€ÏŒ JSON backup\nCancel: Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® Î±Ï€ÏŒ HTML ÏƒÎµÎ»Î¹Î´Î¿Î´ÎµÎ¯ÎºÏ„ÎµÏ‚");
  const inp=document.createElement("input");
  inp.type="file"; inp.accept = choice ? ".json" : ".html,.htm,.txt";
  inp.onchange=()=>{
    const r=new FileReader();
    r.onload=()=>{
      if(choice){
        try{
          const d=JSON.parse(r.result);
          if(d.categories && d.catOrder){
            pushHistory();
            categories=d.categories;catOrder=d.catOrder;
            if(d.theme){applyTheme(d.theme);saveTheme(d.theme);}
            saveData(); render(); updateUndoBtn();
          } else { alert("ÎœÎ· Î­Î³ÎºÏ…ÏÎ¿ JSON."); }
        }catch{ alert("ÎœÎ· Î­Î³ÎºÏ…ÏÎ¿ JSON."); }
      } else {
        const merge = confirm("OK: Î£Ï…Î³Ï‡ÏÎ½ÎµÏ…ÏƒÎ· (Î´ÎµÎ½ Ï€ÏÎ¿ÏƒÎ¸Î­Ï„ÎµÎ¹ Î´Î¹Ï€Î»Î¬)\nCancel: Î‘Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·");
        const parser = new DOMParser();
        const doc = parser.parseFromString(r.result,"text/html");
        const anchors = Array.from(doc.querySelectorAll("a[href]"));
        if(anchors.length===0){ alert("Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ links ÏƒÏ„Î¿ HTML."); return; }
        if(!merge){ pushHistory(); categories={}; catOrder=[]; }

        function closestHeading(el){
          let cur=el; for(let i=0;i<4 && cur;i++, cur=cur.previousElementSibling){
            if(/H[1-3]/.test(cur.tagName)) return cur.textContent.trim();
          }
          let p=el.parentElement; while(p){
            const h = p.querySelector("h3,h2,h1"); if(h) return h.textContent.trim();
            p=p.parentElement;
          }
          return "Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®";
        }

        let added=0;
        anchors.forEach(a=>{
          let href=a.getAttribute("href")||"";
          if(!href) return;
          if(!/^https?:\/\//i.test(href) && !/^www\./i.test(href)) return;
          const url = normalizeUrl(href);
          const name = (a.getAttribute("title")||a.textContent||"").trim();
          const desc = "";
          const cat = closestHeading(a);
          if(!(categories[cat])){ categories[cat]=[]; catOrder.push(cat); }
          const ok = dedupeAdd(cat, {url,name,desc,iconType:"auto",iconValue:null,pinned:false});
          if(ok) added++;
        });

        saveData(); render(); updateUndoBtn();
        alert("Î•Î¹ÏƒÎ±Î³Ï‰Î³Î® HTML Î¿Î»Î¿ÎºÎ»Î·ÏÏÎ¸Î·ÎºÎµ. Î ÏÎ¿ÏƒÏ„Î­Î¸Î·ÎºÎ±Î½ "+added+" links.");
      }
    };
    r.readAsText(inp.files[0]);
  };
  inp.click();
};

/* ===============================
   ğŸ“Œ Î Î±Î»Î­Ï„Î± Î§ÏÏ‰Î¼Î¬Ï„Ï‰Î½
   =============================== */
document.getElementById("paletteBtn").onclick=
  ()=>document.getElementById("paletteModal").style.display="flex";
document.getElementById("closePalette").onclick=
  ()=>document.getElementById("paletteModal").style.display="none";

["bg1","bg2","card","text","accent"].forEach(id=>{
  const el = document.getElementById(id);
  if(!el) return;
  el.oninput=e=>{
    document.documentElement.style.setProperty("--"+id,e.target.value);
    // update swatch if exists
    const sw = document.getElementById('swatch-'+id);
    if(sw) sw.style.background = e.target.value;
    pushHistory();
    saveTheme(getTheme());
  };
});
document.getElementById("defaultPalette").onclick=()=>{
  applyTheme(themeDefault);
  saveTheme(themeDefault);
  ["bg1","bg2","card","text","accent"].forEach(id=>{
    const el=document.getElementById(id);
    if(el) el.value = themeDefault[id];
    const sw = document.getElementById('swatch-'+id);
    if(sw) sw.style.background = themeDefault[id];
  });
  pushHistory();
};

/* ===============================
   ğŸ“Œ Undo
   =============================== */
document.getElementById("undoBtnTop").onclick=undo;

/* ===============================
   ğŸ“Œ Drag & Drop (links ÎºÎ±Î¹ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯ÎµÏ‚)
   =============================== */
let dragSrc=null;
document.addEventListener("dragstart",e=>{
  const c=e.target.closest(".card"),
        cat=e.target.closest(".category");
  if(c){dragSrc=c;} else if(cat){dragSrc=cat;}
});
document.addEventListener("dragover",e=>{
  if(e.target.closest(".card")||e.target.closest(".category")) e.preventDefault();
});
document.addEventListener("drop",e=>{
  e.preventDefault(); if(!dragSrc) return;
  const card=e.target.closest(".card"),
        cat=e.target.closest(".category");

  // ÎœÎµÏ„Î±Ï†Î¿ÏÎ¬ link
  if(dragSrc.classList.contains("card")){
    const f=dragSrc.dataset.cat, i=+dragSrc.dataset.idx, l=categories[f][i];
    pushHistory();
    categories[f].splice(i,1);
    if(card && card!==dragSrc){
      categories[card.dataset.cat].splice(+card.dataset.idx,0,l);
    }else if(cat){
      categories[cat.dataset.cat].push(l);
    }else{
      categories[f].push(l);
    }
    saveData(); render();
  }

  // ÎœÎµÏ„Î±Ï†Î¿ÏÎ¬ ÎºÎ±Ï„Î·Î³Î¿ÏÎ¯Î±Ï‚
  if(dragSrc.classList.contains("category") && cat){
    const fi=catOrder.indexOf(dragSrc.dataset.cat),
          ti=catOrder.indexOf(cat.dataset.cat);
    pushHistory();
    catOrder.splice(fi,1);
    catOrder.splice(ti,0,dragSrc.dataset.cat);
    saveData(); render();
  }
  dragSrc=null;
});

/* ===============================
   ğŸ“Œ Î˜Î­Î¼Î±Ï„Î±
=============================== */
const themes = {
  dark: { bg1:"#0d1b2a", bg2:"#1b263b", card:"#415a77", text:"#e0e1dd", accent:"#00bcd4" },
  light: { bg1:"#f0f4f8", bg2:"#ffffff", card:"#e0e7ef", text:"#2c3e50", accent:"#1565c0" },
  green: { bg1:"#2b2f24", bg2:"#3b4330", card:"#5a6b4c", text:"#f2f5e9", accent:"#a4c639" },
  brown: { bg1:"#332020", bg2:"#4a2b2b", card:"#663d3d", text:"#faeeee", accent:"#e57373"},
  purple: { bg1:"#2a1f38", bg2:"#3a2b4d", card:"#513d66", text:"#f5edf9", accent:"#ba68c8" },
  blue: { bg1:"#102840", bg2:"#16324f", card:"#1e4060", text:"#e3f2fd", accent:"#64b5f6" },
  orange: { bg1:"#402010", bg2:"#5a2b15", card:"#73381c", text:"#fff3e0", accent:"#ffb74d" },
  pink: { bg1:"#3d1f2b", bg2:"#522a3d", card:"#66384e", text:"#fce4ec", accent:"#f48fb1" }
};

function applyTheme(t){
  for(const [k,v] of Object.entries(t)){
    document.documentElement.style.setProperty("--"+k, v);
  }
}

function getTheme(){
  const cs = getComputedStyle(document.documentElement);
  return {
    bg1: cs.getPropertyValue("--bg1").trim(),
    bg2: cs.getPropertyValue("--bg2").trim(),
    card: cs.getPropertyValue("--card").trim(),
    text: cs.getPropertyValue("--text").trim(),
    accent: cs.getPropertyValue("--accent").trim()
  };
}

// Î±Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· theme (ÏŒÎ½Î¿Î¼Î± Î® custom)
function saveTheme(nameOrObj){ 
  if(typeof nameOrObj === "string"){
    localStorage.setItem("themeName", nameOrObj);
    localStorage.removeItem("customTheme");
  } else {
    localStorage.setItem("themeName", "custom");
    localStorage.setItem("customTheme", JSON.stringify(nameOrObj));
  }
}

// Ï†ÏŒÏÏ„Ï‰Î¼Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏ…Î¼Î­Î½Î¿Ï… Î¸Î­Î¼Î±Ï„Î¿Ï‚
function loadTheme(){
  let name = localStorage.getItem("themeName") || "dark";
  let t = null;

  if(name === "custom"){
    t = JSON.parse(localStorage.getItem("customTheme") || "null");
    if(t) applyTheme(t);
  } else {
    t = themes[name] || themes.dark;
    applyTheme(t);
  }

  // ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· dropdown
  const sel = document.getElementById("themeSelect");
  if(sel){
    if(name === "custom"){
      // Î‘Î½ Î´ÎµÎ½ Ï…Ï€Î¬ÏÏ‡ÎµÎ¹ ÎµÏ€Î¹Î»Î¿Î³Î® custom ÏƒÏ„Î¿ select â†’ Ï€ÏÏŒÏƒÎ¸ÎµÏƒÎ­ Ï„Î·Î½
      if(![...sel.options].some(o => o.value === "custom")){
        sel.add(new Option("Custom", "custom"));
      }
      sel.value = "custom";
    } else {
      sel.value = name;
    }
  }
}

// Î±Î»Î»Î±Î³Î® ÏŒÏ„Î±Î½ ÎµÏ€Î¹Î»Î­Î³ÎµÎ¹Ï‚ Î±Ï€ÏŒ Ï„Î¿ dropdown
document.getElementById("themeSelect").addEventListener("change", e => {
  let chosen = e.target.value;
  if(themes[chosen]){
    applyTheme(themes[chosen]);
    saveTheme(chosen);
  }
});


// ÎºÎ»Î®ÏƒÎ· ÏƒÏ„Î·Î½ ÎµÎºÎºÎ¯Î½Î·ÏƒÎ·
loadTheme();

loadData(); 
if(catOrder.length===0){
  categories={"Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®":[]};
  catOrder=["Î•Î¹ÏƒÎ±Î³Ï‰Î³Î®"];
  saveData();
}
render(); updateUndoBtn();





// Î£Ï…Î½Î´Î­ÎµÎ¹ previews Î¼Îµ inputs
document.querySelectorAll("input[type=color]").forEach(input => {
  const preview = document.getElementById("preview-" + input.id);
  if (preview) {
    preview.style.background = input.value;

    // ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ· preview ÏŒÏ„Î±Î½ Î±Î»Î»Î¬Î¶ÎµÎ¹ Ï„Î¿ Ï‡ÏÏÎ¼Î±
    input.addEventListener("input", () => {
      preview.style.background = input.value;
    });

    // click ÏƒÏ„Î¿ preview Î±Î½Î¿Î¯Î³ÎµÎ¹ Ï„Î¿Î½ picker
    preview.addEventListener("click", () => input.click());

    // click ÏƒÏ„Î¿ label Î±Î½Î¿Î¯Î³ÎµÎ¹ Ï„Î¿Î½ picker
    const label = document.querySelector("label[for=" + input.id + "]");
    if (label) {
      label.addEventListener("click", () => input.click());
    }
  }
});


// update palette swatches initial
["bg1","bg2","card","text","accent"].forEach(id=>{
  const el=document.getElementById(id);
  const sw=document.getElementById('swatch-'+id);
  if(el && sw) sw.style.background = el.value || getTheme()[id];
});

</script>
</body>
</html>
